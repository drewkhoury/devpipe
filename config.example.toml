# =============================================================================
# devpipe Configuration Reference
# =============================================================================
# This is a comprehensive example showing ALL available configuration options.
# Copy sections you need to your own config.toml.
#
# Quick Start:
#   [tasks.my-task]
#   command = "npm test"
#
# Full documentation: https://github.com/drewkhoury/devpipe
# =============================================================================

# -----------------------------------------------------------------------------
# [defaults] - Global configuration options
# -----------------------------------------------------------------------------

[defaults]
# Directory for run outputs and logs
# Default: .devpipe
outputRoot = ".devpipe"

# Tasks longer than this (seconds) are skipped with --fast
# Default: 300
fastThreshold = 300

# UI mode: basic or full
# Default: basic
# Valid values: basic, full
uiMode = "basic"

# Dashboard refresh rate in milliseconds
# Default: 500
animationRefreshMs = 500

# Group tasks by phase or type in dashboard
# Default: phase
# Valid values: phase, type
animatedGroupBy = "phase"


# -----------------------------------------------------------------------------
# [defaults.git] - Git integration settings
# -----------------------------------------------------------------------------

[defaults.git]
# Git mode: staged, staged_unstaged, or ref
# Default: staged_unstaged
# Valid values: staged, staged_unstaged, ref
mode = "staged_unstaged"

# Git ref to compare against when mode is ref
# Default: HEAD
ref = "HEAD"


# -----------------------------------------------------------------------------
# [task_defaults] - Default values that apply to all tasks unless overridden at the task level
# -----------------------------------------------------------------------------

[task_defaults]
# Whether tasks are enabled by default
# Default: true
enabled = true

# Default working directory for tasks
# Default: .
workdir = "."

# Default fix behavior: auto, helper, or none
# Default: 
# Valid values: auto, helper, none
# fixType = 


# -----------------------------------------------------------------------------
# [tasks.<task-id>] - Individual task configuration. Task ID must be unique.
# -----------------------------------------------------------------------------

# Example task with all options:
[tasks.example-task]
# Shell command to execute
# Required: yes
# command = 

# Display name for the task
# Default: 
# name = 

# Description
# Default: 
# desc = 

# Task type for grouping (e.g., check, build, test)
# Default: 
# type = 

# Working directory for this task
# Default: 
# workdir = 

# Whether this task is enabled
# Default: 
# enabled = 

# Metrics format: junit, sarif, artifact
# Default: 
# Valid values: junit, sarif, artifact
# metricsFormat = 

# Path to metrics file (relative to workdir)
# Default: 
# metricsPath = 

# Fix behavior: auto, helper, none (overrides task_defaults)
# Default: 
# Valid values: auto, helper, none
# fixType = 

# Command to run to fix issues (required if fixType is set)
# Default: 
# fixCommand = 

# File patterns to watch (glob patterns relative to workdir). Task runs only if matching files changed.
# Default: 
# watchPaths = 


# -----------------------------------------------------------------------------
# Phase-Based Execution
# -----------------------------------------------------------------------------
# Use [tasks.phase-<name>] to create phase headers.
# Tasks under a phase header run in parallel. Phases execute sequentially.

[tasks.phase-quality]
name = "Quality Checks"
desc = "Linting and formatting"

[tasks.lint]
command = "npm run lint"
type = "check"

[tasks.format]
command = "npm run format:check"
type = "check"

[tasks.phase-build]
name = "Build"

[tasks.build]
command = "npm run build"
type = "build"

[tasks.phase-test]
name = "Tests"

[tasks.unit-tests]
command = "npm test"
type = "test"
metricsFormat = "junit"
metricsPath = "test-results/junit.xml"

[tasks.e2e-tests]
command = "npm run test:e2e"
type = "test"
